{"version":3,"sources":["webpack:///./src/views/token/index.vue?1c65","webpack:///src/views/token/index.vue","webpack:///./src/views/token/index.vue?9fad","webpack:///./src/views/token/index.vue","webpack:///./src/utils/request.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","on","login","_v","freash","request","staticRenderFns","component","encryptor","JSEncrypt","publicKey","setPublicKey","secretWord","encrypt","name","console","log","privateKey","decrypt","setPrivateKey","service","axios","create","baseURL","timeout","interceptors","use","config","headers","localStorage","getItem","method","error","Promise","reject","response"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,GAAG,CAAC,MAAQN,EAAIO,QAAQ,CAACP,EAAIQ,GAAG,QAAQJ,EAAG,MAAMA,EAAG,SAAS,CAACE,GAAG,CAAC,MAAQN,EAAIS,SAAS,CAACT,EAAIQ,GAAG,aAAaJ,EAAG,MAAMA,EAAG,SAAS,CAACE,GAAG,CAAC,MAAQN,EAAIU,UAAU,CAACV,EAAIQ,GAAG,WACvRG,EAAkB,G,YCWtB,GACE,KAAF,QACE,QAFF,aAKE,QAAF,CACI,MADJ,WAEM,OAAN,OAAM,CAAN,CACQ,OAAR,MACQ,IAAR,SACQ,KAAR,KACA,kBACQ,aAAR,wCACQ,aAAR,mDACQ,QAAR,kEACQ,QAAR,gFAGI,QAbJ,WAcM,OAAN,OAAM,CAAN,CACQ,OAAR,MACQ,IAAR,QACQ,KAAR,KACA,sBAEA,mBAAQ,OAAR,mBAEI,OAtBJ,WAuBM,OAAN,OAAM,CAAN,CACQ,OAAR,MACQ,IAAR,2BACQ,KAAR,QC3C4d,I,YCOxdC,EAAY,eACd,EACAb,EACAY,GACA,EACA,KACA,WACA,MAIa,aAAAC,E,8GCdXC,GAFY,IAAIC,OAEJ,IAAIA,QAEhBC,EAAY,iOAIhBF,EAAUG,aAAaD,GACvB,IAAIE,EAAaJ,EAAUK,QAAQ,CAAEC,KAAM,OAC3CC,QAAQC,IAAIJ,GAGZ,IAAIK,EAAa,u0BAabC,EAAU,IAAIT,OAClBS,EAAQC,cAAcF,GACtBF,QAAQC,IAAIE,EAAQA,QAAQN,IAE5B,IAAMQ,EAAUC,IAAMC,OAAO,CACzBC,QAAS,4BACTC,QAAS,MAIbJ,EAAQK,aAAapB,QAAQqB,KACzB,SAAAC,GAUI,OARAA,EAAOC,QAAQ,cAAgBC,aAAaC,QAAQ,cACpDf,QAAQC,IAAIW,GAES,QAAlBA,EAAOI,QAEDJ,EAAOI,OAGTJ,KAEX,SAAAK,GAEI,OAAOC,QAAQC,OAAOF,MAK9BZ,EAAQK,aAAaU,SAAST,KAC1B,SAAAS,GAGI,OADApB,QAAQC,IAAImB,GACLA,KAUX,SAAAH,GAEI,OAAOC,QAAQC,OAAOF,MAwBfZ","file":"js/chunk-3909d0ae.c6144c14.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('button',{on:{\"click\":_vm.login}},[_vm._v(\"登录\")]),_c('br'),_c('button',{on:{\"click\":_vm.freash}},[_vm._v(\"刷新token\")]),_c('br'),_c('button',{on:{\"click\":_vm.request}},[_vm._v(\"请求\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <button @click=\"login\">登录</button>\n        <br>\n        <button @click=\"freash\">刷新token</button>\n        <br>\n        <button @click=\"request\">请求</button>\n    </div>\n</template>\n\n<script>\nimport service from '@/utils/request.js'\nexport default {\n    name: 'index',\n    mounted() {\n        // this.login()\n    },\n    methods: {\n        login() {\n            service({\n                method: 'get',\n                url: '/login',\n                data: {}\n            }).then(res => {\n                localStorage.setItem('auth-token', res.data.data.token);\n                localStorage.setItem('refreashToken', res.data.data.refreashToken);\n                console.log('token失效时间' + new Date(res.data.data.token).toLocaleTimeString())\n                console.log('刷新token失效时间' + new Date(res.data.data.refreashToken).toLocaleTimeString())\n            })\n        },\n        request() {\n            service({\n                method: 'get',\n                url: '/list',\n                data: {}\n            }).then(res => {\n                // console.log(res)\n            }).catch(e => console.log(e))\n        },\n        freash() {\n            service({\n                method: 'get',\n                url: `/login/refreashToken/123`,\n                data: {}\n            })\n        }\n    },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!../../loader/goOutside.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!../../loader/goOutside.js!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a035b508&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a035b508\",\n  null\n  \n)\n\nexport default component.exports","import axios from 'axios';\nimport { JSEncrypt } from 'jsencrypt'\nconst Encrypt = new JSEncrypt ();\n\nlet encryptor = new JSEncrypt() // 新建JSEncrypt对象\n\nlet publicKey = `MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDlOJu6TyygqxfWT7eLtGDwajtN\nFOb9I5XRb6khyfD1Yt3YiCgQWMNW649887VGJiGr/L5i2osbl8C9+WJTeucF+S76\nxFxdU6jE0NQ+Z+zEdhUTooNRaY5nZiu5PgDB0ED/ZKBUSLKL7eibMxZtMlUDHjm4\ngwQco1KRMDSmXSMkDwIDAQAB`\nencryptor.setPublicKey(publicKey) // 设置公钥\nlet secretWord = encryptor.encrypt({ name: '张三' })\nconsole.log(secretWord)\n\n\nlet privateKey = 'MIICXQIBAAKBgQDlOJu6TyygqxfWT7eLtGDwajtNFOb9I5XRb6khyfD1Yt3YiCgQ\\n' +\n    'WMNW649887VGJiGr/L5i2osbl8C9+WJTeucF+S76xFxdU6jE0NQ+Z+zEdhUTooNR\\n' +\n    'aY5nZiu5PgDB0ED/ZKBUSLKL7eibMxZtMlUDHjm4gwQco1KRMDSmXSMkDwIDAQAB\\n' +\n    'AoGAfY9LpnuWK5Bs50UVep5c93SJdUi82u7yMx4iHFMc/Z2hfenfYEzu+57fI4fv\\n' +\n    'xTQ//5DbzRR/XKb8ulNv6+CHyPF31xk7YOBfkGI8qjLoq06V+FyBfDSwL8KbLyeH\\n' +\n    'm7KUZnLNQbk8yGLzB3iYKkRHlmUanQGaNMIJziWOkN+N9dECQQD0ONYRNZeuM8zd\\n' +\n    '8XJTSdcIX4a3gy3GGCJxOzv16XHxD03GW6UNLmfPwenKu+cdrQeaqEixrCejXdAF\\n' +\n    'z/7+BSMpAkEA8EaSOeP5Xr3ZrbiKzi6TGMwHMvC7HdJxaBJbVRfApFrE0/mPwmP5\\n' +\n    'rN7QwjrMY+0+AbXcm8mRQyQ1+IGEembsdwJBAN6az8Rv7QnD/YBvi52POIlRSSIM\\n' +\n    'V7SwWvSK4WSMnGb1ZBbhgdg57DXaspcwHsFV7hByQ5BvMtIduHcT14ECfcECQATe\\n' +\n    'aTgjFnqE/lQ22Rk0eGaYO80cc643BXVGafNfd9fcvwBMnk0iGX0XRsOozVt5Azil\\n' +\n    'psLBYuApa66NcVHJpCECQQDTjI2AQhFc1yRnCU/YgDnSpJVm1nASoRUnU8Jfm3Oz\\n' +\n    'uku7JUXcVpt08DFSceCEX9unCuMcT72rAQlLpdZir876'\nlet decrypt = new JSEncrypt() // 新建JSEncrypt对象\ndecrypt.setPrivateKey(privateKey)\nconsole.log(decrypt.decrypt(secretWord))\n\nconst service = axios.create({\n    baseURL: 'https://10.15.85.197:7002',\n    timeout: 5000,\n});\n\n// 添加请求拦截器\nservice.interceptors.request.use(\n    config => {\n        // 在发送请求之前做些什么\n        config.headers['auth-token'] = localStorage.getItem('auth-token');\n        console.log(config)\n        // console.log(config.data = encryptor.encrypt(config.data))\n        if(config.method === 'get') {\n\n        }else if(config.method === 'post') {\n\n        }\n        return config;\n    },\n    error => {\n        // 对请求错误做些什么\n        return Promise.reject(error);\n    },\n);\n\n// 添加响应拦截器\nservice.interceptors.response.use(\n    response => {\n        // 对响应数据做点什么\n        console.log(response)\n        return response\n        // if(response.data.code === 'AAAAAAAAAA') {\n        //     return response;\n        // }else if(response.data.code === '401') {\n        //     console.log('token失效')\n        //     return doRequest(response.config)\n        // }else{\n        //     return Promise.reject('请求出错');\n        // }\n    },\n    error => {\n        // 对响应错误做点什么\n        return Promise.reject(error);\n    },\n);\n\n// 刷新逻辑\nlet doRequest = async function (config) {\n    let refreashToken = localStorage.getItem('refreashToken')\n    let tokenRes = await service({\n        method: 'get',\n        url: `/login/refreashToken/${refreashToken}`,\n        data: {}\n    })\n    console.log(11111)\n\n    if(tokenRes.data.code === 'AAAAAAAAAA') {\n        console.log('token已刷新,失效时间' + new Date(tokenRes.data.data.token).toLocaleTimeString())\n        console.log('刷新token已刷新,失效时间' + new Date(tokenRes.data.data.refreashToken).toLocaleTimeString())\n\n        localStorage.setItem('auth-token', tokenRes.data.data.token);\n        localStorage.setItem('refreashToken', tokenRes.data.data.refreashToken);\n    }\n    return await service(config)\n}\nexport const a = 2\nexport default service;\n"],"sourceRoot":""}